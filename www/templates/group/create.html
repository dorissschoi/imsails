<form name="groupCreate">
<ion-header-bar class="item-input-inset">
	<button class="button button-icon button-clear ion-navicon" menu-toggle="left">
    </button>
	<h1 class='title'>
		{{'Group Create' | translate}}
	</h1>
	<a class="button button-clear" ng-click="save()">{{'Save' | translate}}</a>
</ion-header-bar>
<ion-content>
	<div class="row">
		<div class="col col-33">
			<div class="fileButton">
				<icon class="photo edit"
					ng-src="model.photoUrl"
					aria-label="{{model.name}}"
					otherwise="icon ion-android-people">
				</icon>
				<input type="file"
					accept="image/*"
					onchange="angular.element(this).scope().select(event.target.files)">
			</div>
		</div>
		<div class="col">
			<label class="item item-input" ng-class="{'has-error': groupCreate.name.$invalid}">
				<input type="text" name="name" ng-model="model.name" placeholder="Name" required>
			</label>
			<div ng-messages="groupCreate.name.$error"
				role="alert"
				ng-show="groupCreate.name.$error">
				<div class="form-error" ng-if="groupCreate.name.$error.required">This field is required</div>
				<div class="form-error" ng-if="groupCreate.name.$error.server">{{groupCreate.name.$error.server}}</div>
			</div>
			<fancy-select
				template-url='templates/user/status.html'
				ng-selected="model.type"
				ng-model="resource.Group.type.values"
				title="Select group type">
			</fancy-select>
		</div>
	</div>
	<div ng-repeat="type in ['moderators', 'members']">
		<ion-list>
			<ion-item class="item-divider">
				{{resource.Group.type.placeholder[type]}}
			</ion-item>

			<div class="row">
				<div class="col">
					<fancy-select-model
						template-url='templates/user/select.html'
						label="fullname"
						multiple
						ng-selected="$parent.model[type]"
						ng-model="users"
						title="Select {{type}}">
					</fancy-select-model>
				</div>
			</div>

			<ion-item class="item-avatar"
				ng-repeat="user in model[type]"
				ng-controller="UserCtrl">
				<icon class="avatar"
					ng-src="user.photoUrl"
					aria-label="{{user.fullname()}}"
					otherwise="icon ion-android-person">
				</icon>
				<h2>
					<span>{{user.fullname()}}</span>
				</h2>
				<p>
					{{user.post()}}
				</p>
				<ion-option-button class="button button-assertive icon-left ion-trash-a" on-tap="model[type].splice($index, 1)">Delete</ion-option-button>
			</ion-item>
		</ion-list>
	</div>
</ion-content>
</form>
